{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "ac4df541-5bdf-4692-8241-8714e1b3ddd9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>time</th>\n",
       "      <th>comp</th>\n",
       "      <th>round</th>\n",
       "      <th>day</th>\n",
       "      <th>venue</th>\n",
       "      <th>result</th>\n",
       "      <th>gf</th>\n",
       "      <th>ga</th>\n",
       "      <th>opponent</th>\n",
       "      <th>...</th>\n",
       "      <th>match report</th>\n",
       "      <th>notes</th>\n",
       "      <th>sh</th>\n",
       "      <th>sot</th>\n",
       "      <th>dist</th>\n",
       "      <th>fk</th>\n",
       "      <th>pk</th>\n",
       "      <th>pkatt</th>\n",
       "      <th>season</th>\n",
       "      <th>team</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2024-08-17</td>\n",
       "      <td>12:30</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 1</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Away</td>\n",
       "      <td>W</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Ipswich Town</td>\n",
       "      <td>...</td>\n",
       "      <td>Match Report</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18</td>\n",
       "      <td>5</td>\n",
       "      <td>14.8</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2024-08-25</td>\n",
       "      <td>16:30</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 2</td>\n",
       "      <td>Sun</td>\n",
       "      <td>Home</td>\n",
       "      <td>W</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Brentford</td>\n",
       "      <td>...</td>\n",
       "      <td>Match Report</td>\n",
       "      <td>NaN</td>\n",
       "      <td>19</td>\n",
       "      <td>8</td>\n",
       "      <td>13.6</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2024-09-01</td>\n",
       "      <td>16:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 3</td>\n",
       "      <td>Sun</td>\n",
       "      <td>Away</td>\n",
       "      <td>W</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Manchester Utd</td>\n",
       "      <td>...</td>\n",
       "      <td>Match Report</td>\n",
       "      <td>NaN</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>13.4</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2024-09-14</td>\n",
       "      <td>15:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 4</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Home</td>\n",
       "      <td>L</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Nott'ham Forest</td>\n",
       "      <td>...</td>\n",
       "      <td>Match Report</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14</td>\n",
       "      <td>5</td>\n",
       "      <td>14.9</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2024-09-21</td>\n",
       "      <td>15:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 5</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Home</td>\n",
       "      <td>W</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Bournemouth</td>\n",
       "      <td>...</td>\n",
       "      <td>Match Report</td>\n",
       "      <td>NaN</td>\n",
       "      <td>19</td>\n",
       "      <td>12</td>\n",
       "      <td>16.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         date   time            comp        round  day venue result   gf   ga  \\\n",
       "0  2024-08-17  12:30  Premier League  Matchweek 1  Sat  Away      W  2.0  0.0   \n",
       "1  2024-08-25  16:30  Premier League  Matchweek 2  Sun  Home      W  2.0  0.0   \n",
       "2  2024-09-01  16:00  Premier League  Matchweek 3  Sun  Away      W  3.0  0.0   \n",
       "3  2024-09-14  15:00  Premier League  Matchweek 4  Sat  Home      L  0.0  1.0   \n",
       "5  2024-09-21  15:00  Premier League  Matchweek 5  Sat  Home      W  3.0  0.0   \n",
       "\n",
       "          opponent  ...  match report  notes  sh  sot  dist   fk pk pkatt  \\\n",
       "0     Ipswich Town  ...  Match Report    NaN  18    5  14.8  0.0  0     0   \n",
       "1        Brentford  ...  Match Report    NaN  19    8  13.6  1.0  0     0   \n",
       "2   Manchester Utd  ...  Match Report    NaN  11    3  13.4  0.0  0     0   \n",
       "3  Nott'ham Forest  ...  Match Report    NaN  14    5  14.9  0.0  0     0   \n",
       "5      Bournemouth  ...  Match Report    NaN  19   12  16.6  0.0  0     0   \n",
       "\n",
       "  season       team  \n",
       "0   2024  Liverpool  \n",
       "1   2024  Liverpool  \n",
       "2   2024  Liverpool  \n",
       "3   2024  Liverpool  \n",
       "5   2024  Liverpool  \n",
       "\n",
       "[5 rows x 28 columns]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "\n",
    "#read in match data\n",
    "matches = pd.read_csv(\"matches.csv\", index_col=0)\n",
    "matches.head()\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ef8bceea-213a-457c-925e-0e718a9955bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "date              object\n",
       "time              object\n",
       "comp              object\n",
       "round             object\n",
       "day               object\n",
       "venue             object\n",
       "result            object\n",
       "gf               float64\n",
       "ga               float64\n",
       "opponent          object\n",
       "xg               float64\n",
       "xga              float64\n",
       "poss             float64\n",
       "attendance       float64\n",
       "captain           object\n",
       "formation         object\n",
       "opp formation     object\n",
       "referee           object\n",
       "match report      object\n",
       "notes            float64\n",
       "sh                 int64\n",
       "sot                int64\n",
       "dist             float64\n",
       "fk               float64\n",
       "pk                 int64\n",
       "pkatt              int64\n",
       "season             int64\n",
       "team              object\n",
       "dtype: object"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "matches.dtypes\n",
    "#machine algorithms cant work with object data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c0db2649-d193-44f5-bf3a-7ea88b6325b8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "date             datetime64[ns]\n",
       "time                     object\n",
       "comp                     object\n",
       "round                    object\n",
       "day                      object\n",
       "venue                    object\n",
       "result                   object\n",
       "gf                      float64\n",
       "ga                      float64\n",
       "opponent                 object\n",
       "xg                      float64\n",
       "xga                     float64\n",
       "poss                    float64\n",
       "attendance              float64\n",
       "captain                  object\n",
       "formation                object\n",
       "opp formation            object\n",
       "referee                  object\n",
       "match report             object\n",
       "notes                   float64\n",
       "sh                        int64\n",
       "sot                       int64\n",
       "dist                    float64\n",
       "fk                      float64\n",
       "pk                        int64\n",
       "pkatt                     int64\n",
       "season                    int64\n",
       "team                     object\n",
       "dtype: object"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#convert date column into date time using pandas\n",
    "matches[\"date\"] = pd.to_datetime(matches[\"date\"])\n",
    "matches.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "e5675ff3-5d68-496c-bbf4-3de0e1d2d29c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>time</th>\n",
       "      <th>comp</th>\n",
       "      <th>round</th>\n",
       "      <th>day</th>\n",
       "      <th>venue</th>\n",
       "      <th>result</th>\n",
       "      <th>gf</th>\n",
       "      <th>ga</th>\n",
       "      <th>opponent</th>\n",
       "      <th>...</th>\n",
       "      <th>fk</th>\n",
       "      <th>pk</th>\n",
       "      <th>pkatt</th>\n",
       "      <th>season</th>\n",
       "      <th>team</th>\n",
       "      <th>venue_code</th>\n",
       "      <th>opp_code</th>\n",
       "      <th>hour</th>\n",
       "      <th>day_code</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2024-08-17</td>\n",
       "      <td>12:30</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 1</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Away</td>\n",
       "      <td>W</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Ipswich Town</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>12</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2024-08-25</td>\n",
       "      <td>16:30</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 2</td>\n",
       "      <td>Sun</td>\n",
       "      <td>Home</td>\n",
       "      <td>W</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Brentford</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>16</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2024-09-01</td>\n",
       "      <td>16:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 3</td>\n",
       "      <td>Sun</td>\n",
       "      <td>Away</td>\n",
       "      <td>W</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Manchester Utd</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>16</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2024-09-14</td>\n",
       "      <td>15:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 4</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Home</td>\n",
       "      <td>L</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Nott'ham Forest</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "      <td>1</td>\n",
       "      <td>15</td>\n",
       "      <td>15</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2024-09-21</td>\n",
       "      <td>15:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 5</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Home</td>\n",
       "      <td>W</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Bournemouth</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2024</td>\n",
       "      <td>Liverpool</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>15</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2024-08-31</td>\n",
       "      <td>15:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 3</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Away</td>\n",
       "      <td>D</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Nott'ham Forest</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2022</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>0</td>\n",
       "      <td>15</td>\n",
       "      <td>15</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2024-09-15</td>\n",
       "      <td>16:30</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 4</td>\n",
       "      <td>Sun</td>\n",
       "      <td>Home</td>\n",
       "      <td>L</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Newcastle Utd</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2022</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>1</td>\n",
       "      <td>14</td>\n",
       "      <td>16</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2024-09-21</td>\n",
       "      <td>15:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 5</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Away</td>\n",
       "      <td>L</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>Aston Villa</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2022</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>15</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2024-09-28</td>\n",
       "      <td>17:30</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 6</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Home</td>\n",
       "      <td>L</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Liverpool</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2022</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>1</td>\n",
       "      <td>11</td>\n",
       "      <td>17</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2024-10-05</td>\n",
       "      <td>15:00</td>\n",
       "      <td>Premier League</td>\n",
       "      <td>Matchweek 7</td>\n",
       "      <td>Sat</td>\n",
       "      <td>Away</td>\n",
       "      <td>L</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Brentford</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2022</td>\n",
       "      <td>Wolverhampton Wanderers</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>15</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>420 rows × 33 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         date   time            comp        round  day venue result   gf   ga  \\\n",
       "0  2024-08-17  12:30  Premier League  Matchweek 1  Sat  Away      W  2.0  0.0   \n",
       "1  2024-08-25  16:30  Premier League  Matchweek 2  Sun  Home      W  2.0  0.0   \n",
       "2  2024-09-01  16:00  Premier League  Matchweek 3  Sun  Away      W  3.0  0.0   \n",
       "3  2024-09-14  15:00  Premier League  Matchweek 4  Sat  Home      L  0.0  1.0   \n",
       "5  2024-09-21  15:00  Premier League  Matchweek 5  Sat  Home      W  3.0  0.0   \n",
       "..        ...    ...             ...          ...  ...   ...    ...  ...  ...   \n",
       "3  2024-08-31  15:00  Premier League  Matchweek 3  Sat  Away      D  1.0  1.0   \n",
       "4  2024-09-15  16:30  Premier League  Matchweek 4  Sun  Home      L  1.0  2.0   \n",
       "6  2024-09-21  15:00  Premier League  Matchweek 5  Sat  Away      L  1.0  3.0   \n",
       "7  2024-09-28  17:30  Premier League  Matchweek 6  Sat  Home      L  1.0  2.0   \n",
       "8  2024-10-05  15:00  Premier League  Matchweek 7  Sat  Away      L  3.0  5.0   \n",
       "\n",
       "           opponent  ...   fk  pk  pkatt  season                     team  \\\n",
       "0      Ipswich Town  ...  0.0   0      0    2024                Liverpool   \n",
       "1         Brentford  ...  1.0   0      0    2024                Liverpool   \n",
       "2    Manchester Utd  ...  0.0   0      0    2024                Liverpool   \n",
       "3   Nott'ham Forest  ...  0.0   0      0    2024                Liverpool   \n",
       "5       Bournemouth  ...  0.0   0      0    2024                Liverpool   \n",
       "..              ...  ...  ...  ..    ...     ...                      ...   \n",
       "3   Nott'ham Forest  ...  0.0   0      0    2022  Wolverhampton Wanderers   \n",
       "4     Newcastle Utd  ...  0.0   0      0    2022  Wolverhampton Wanderers   \n",
       "6       Aston Villa  ...  0.0   0      0    2022  Wolverhampton Wanderers   \n",
       "7         Liverpool  ...  0.0   0      0    2022  Wolverhampton Wanderers   \n",
       "8         Brentford  ...  0.0   0      0    2022  Wolverhampton Wanderers   \n",
       "\n",
       "   venue_code opp_code hour day_code  target  \n",
       "0           0        9   12        5       1  \n",
       "1           1        3   16        6       1  \n",
       "2           0       13   16        6       1  \n",
       "3           1       15   15        5       0  \n",
       "5           1        2   15        5       1  \n",
       "..        ...      ...  ...      ...     ...  \n",
       "3           0       15   15        5       0  \n",
       "4           1       14   16        6       0  \n",
       "6           0        1   15        5       0  \n",
       "7           1       11   17        5       0  \n",
       "8           0        3   15        5       0  \n",
       "\n",
       "[420 rows x 33 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#create a few basic predictors to create a straightforward machine learning model.\n",
    "#this will be the base\n",
    "\n",
    "#create home or away column into a numeric column (for home field advantage)\n",
    "matches[\"venue_code\"] =  matches[\"venue\"].astype(\"category\").cat.codes\n",
    "\n",
    "#.cat.codes converts into integers\n",
    "\n",
    "#create unique code for each opponent squad\n",
    "matches[\"opp_code\"] = matches[\"opponent\"].astype(\"category\").cat.codes\n",
    "matches[\"hour\"] = matches[\"time\"].str.replace(\":.+\", \"\", regex=True).astype(\"int\")\n",
    "matches[\"day_code\"] = matches[\"date\"].dt.dayofweek\n",
    "\n",
    "#setup a target that we want to try to predict ( whether team won or not)\n",
    "matches[\"target\"] = (matches[\"result\"] == \"W\").astype(\"int\")\n",
    "#if result is w then it will result in a true boolean, and then astype will turn true into 1.\n",
    "\n",
    "#if result is loss or draw = 0, win = 1)\n",
    "\n",
    "matches"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "09bc8379-2092-4ec8-9b77-291f8027a382",
   "metadata": {},
   "outputs": [],
   "source": [
    "#train machine learning model!\n",
    "\n",
    "#import random forest classifier (ml model). This model is able to pickup\n",
    "#non linearities in the data\n",
    "\n",
    "from sklearn.ensemble import RandomForestClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "d4e1cba8-6006-4b8d-817c-05fc3d78c612",
   "metadata": {},
   "outputs": [],
   "source": [
    "rf = RandomForestClassifier(n_estimators=50, min_samples_split=10, random_state=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "f8a18410-79ff-4037-8b1e-4bef1520dfb4",
   "metadata": {},
   "outputs": [],
   "source": [
    "train = matches[matches[\"date\"] < '2024-09-01']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "f53d3a16-053d-482f-9a90-7cc153061d92",
   "metadata": {},
   "outputs": [],
   "source": [
    "test = matches[matches[\"date\"] >= '2024-09-01']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "a55bd3f1-4f57-4def-84fe-734f6afb7f5e",
   "metadata": {},
   "outputs": [],
   "source": [
    "predictors = [\"venue_code\", \"opp_code\", \"hour\", \"day_code\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4447c8d0-8add-43f5-ab42-9a6316844c66",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        date   time            comp        round  day venue result   gf   ga  \\\n",
      "0 2024-08-17  12:30  Premier League  Matchweek 1  Sat  Away      W  2.0  0.0   \n",
      "1 2024-08-25  16:30  Premier League  Matchweek 2  Sun  Home      W  2.0  0.0   \n",
      "1 2024-08-18  16:30  Premier League  Matchweek 1  Sun  Away      W  2.0  0.0   \n",
      "2 2024-08-24  15:00  Premier League  Matchweek 2  Sat  Home      W  4.0  1.0   \n",
      "3 2024-08-31  17:30  Premier League  Matchweek 3  Sat  Away      W  3.0  1.0   \n",
      "\n",
      "       opponent  ...   fk  pk  pkatt  season             team venue_code  \\\n",
      "0  Ipswich Town  ...  0.0   0      0    2024        Liverpool          0   \n",
      "1     Brentford  ...  1.0   0      0    2024        Liverpool          1   \n",
      "1       Chelsea  ...  0.0   0      0    2024  Manchester City          0   \n",
      "2  Ipswich Town  ...  1.0   1      1    2024  Manchester City          1   \n",
      "3      West Ham  ...  1.0   0      0    2024  Manchester City          0   \n",
      "\n",
      "  opp_code hour day_code  target  \n",
      "0        9   12        5       1  \n",
      "1        3   16        6       1  \n",
      "1        5   16        6       1  \n",
      "2        9   15        5       1  \n",
      "3       18   17        5       1  \n",
      "\n",
      "[5 rows x 33 columns]\n",
      "2024-08-16 00:00:00 2024-10-06 00:00:00\n"
     ]
    }
   ],
   "source": [
    "print(train.head())\n",
    "print(matches[\"date\"].min(), matches[\"date\"].max())"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
